<div class="container d-flex justify-content-center">
  <form #f="ngForm" (ngSubmit)="onSubmit(f)" class="card border-0 p-4 rounded-4 shadow-sm w-100"
    style="max-width: 720px;" novalidate>
    <!-- Header -->
    <div class="d-flex align-items-center mb-4 border-bottom pb-3">
      <img [src]="user.avatarUrl || 'assets/avatar/panda.png'" alt="Avatar" class="rounded-circle me-3 shadow-sm"
        width="50" height="50" />
      <div>
        <h6 class="mb-0 fw-semibold">{{ user.name }}</h6>
        <small class="text-muted">Create a tag post</small>
      </div>
    </div>

    <!-- Headline -->
    <div class="mb-4">
      <input type="text" class="form-control form-control-lg border-0 border-bottom rounded-0 shadow-none"
        placeholder="Write something about your tag..." [(ngModel)]="formData.headline" name="headline" required />
    </div>

    <!-- Image Upload -->
    <div class="mb-4">
      <label class="form-label fw-semibold">Images</label>
      <div class="d-flex flex-wrap gap-3">
        <div *ngFor="let img of formData.images; let i = index" class="position-relative">
          <img [src]="img" alt="Selected" class="rounded-3 border" width="90" height="90" />
          <button type="button"
            class="btn btn-sm btn-light border position-absolute top-0 end-0 p-0 px-1 rounded-circle"
            (click)="removeImage(i)">
            √ó
          </button>
        </div>

        <label *ngIf="formData.images.length < 3"
          class="d-flex flex-column justify-content-center align-items-center border rounded-3 bg-light bg-opacity-25"
          style="width:90px; height:90px; cursor:pointer;">
          <i class="bi bi-plus-circle fs-3 text-primary"></i>
          <small class="text-muted">Add</small>
          <input type="file" (change)="onImageSelect($event)" accept="image/*" hidden />
        </label>
      </div>
    </div>

    <!-- Expiry + Tag -->
    <div class="row g-3 mb-3">
      <div class="col-md-6">
        <label class="form-label fw-semibold">Expires In (sec)</label>
        <input type="number" class="form-control" [(ngModel)]="formData.expiresIn" name="expiresIn"
          placeholder="e.g. 3600" required />
      </div>

      <div class="col-md-6">
        <label class="form-label fw-semibold">Tag</label>
        <select class="form-select" [(ngModel)]="formData.tag" name="tag" required>
          <option value="" disabled selected>Select Tag</option>
          <option *ngFor="let t of tags" [value]="t">{{ t | titlecase }}</option>
        </select>
      </div>
    </div>

    <!-- Location -->
    <div class="mb-4">
      <label class="form-label fw-semibold">Location</label>

      <div class="form-control ps-2 bg-light text-muted" style="cursor: default;">
        {{ shared.text() || 'üìç No location selected' }}
      </div>

      <small class="text-muted d-block mt-1">
        Use üìå to locate on the map
      </small>
    </div>


    <!-- Action Buttons -->
    <div class="d-flex justify-content-end gap-3 pt-3 border-top">
      <button type="button" class="btn btn-light border" (click)="onDiscard()">Discard</button>
      <button type="submit" class="btn btn-primary px-4" [disabled]="!f.valid">
        Post
      </button>
    </div>
  </form>
</div>