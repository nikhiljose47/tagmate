<div class="container mt-3">
  <div class="row justify-content-center">
    <!-- Filter Card -->
    <h6 class="fw-bold mb-3">ğŸ” Filter Posts</h6>

    <!-- TAG SEARCH + SELECTED TAGS -->
    <div class="mb-3">
      <div class="d-flex align-items-center mb-1">

        <!-- Label -->
        <label class="form-label small fw-semibold mb-0 me-2">
          Tags (max 2)
        </label>

        <!-- Selected Tags (chips) -->
        <div class="d-flex flex-wrap gap-2">
          <span *ngFor="let t of selectedTags" class="badge rounded-pill bg-success px-3 py-2">
            {{ t }}
            <span class="ms-2" role="button" (click)="removeTag(t)">Ã—</span>
          </span>
        </div>

      </div>

      <div class="d-flex align-items-center gap-2 flex-wrap">

        <!-- Search Box -->
        <input type="text" class="form-control form-control-sm w-auto" style="min-width: 200px;"
          placeholder="Search tag..." [(ngModel)]="tagSearch" />

        <!-- Dropdown: only when typed >= 1 char -->
        <div *ngIf="tagSearch.length >= 1" class="tag-dropdown px-2 py-2 rounded border mt-2">
          <button *ngFor="let tag of filteredTags()" class="btn btn-sm w-100 text-start mb-1" [ngClass]="selectedTags.includes(tag)
                          ? 'btn-success'
                          : 'btn-outline-secondary'" (click)="toggleTag(tag)"
            [disabled]="!selectedTags.includes(tag) && selectedTags.length >= 2">
            {{ tag }}
          </button>
        </div>
      </div>

      <!-- NEXT LINE: RANGE + MONTH -->
      <div class="row g-3 mt-1">

        <div class="col-12 col-md-6">
          <label class="form-label small fw-semibold">Created Within</label>
          <select class="form-select form-select-sm" [(ngModel)]="selectedRange" (change)="onRangeChange()">
            <option value="">-- Select Range --</option>
            <option value="1h">Last 1 hour</option>
            <option value="24h">Last 24 hours</option>
            <option value="7d">Last 7 days</option>
            <option value="30d">Last 30 days</option>
          </select>
        </div>

        <div class="col-12 col-md-6">
          <label class="form-label small fw-semibold">Month</label>
          <input type="month" class="form-control form-control-sm" [(ngModel)]="selectedMonth"
            (change)="onMonthChange()" />
        </div>

      </div>
    </div>

    <!-- Main Content -->
    <!-- INSTAGRAM STYLE POST CARD -->
    <div class="col-12 mb-4" *ngFor="let card of cards">
      <div class="insta-card shadow-sm">

        <!-- IMAGE SECTION -->
        <div class="insta-image-wrapper">
          <img src="assets/abbu.jpg" class="insta-image" />
        </div>

        <!-- TEXT SECTION -->
        <div class="p-3">
          <h5 class="fw-bold mb-1">{{ card.username }}</h5>
          <p class="mb-2">{{ card.highlight }}</p>

          <div class="text-muted small">
            ğŸ“ Lat: {{ card.lat | number:'1.4-4' }},
            Lng: {{ card.lng | number:'1.4-4' }}<br />
            â³ {{ card.expiresIn }}s left
          </div>
        </div>

      </div>
    </div>

  </div>